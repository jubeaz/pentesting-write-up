\chapter{Cascade}
\begin{itemize}
    \item {\bf technics}: 
    \item {\bf Components}: 
    \item {\bf tools}: 
\end{itemize}


\section{Résumé}


\section{Details}

\subsection{Recon}
\subsubsection{nmap}
\begin{verbatim}
$ sudo nmap -sV -sC -Pn -oX cascade.xml 10.10.10.182
Starting Nmap 7.92 ( https://nmap.org ) at 2022-10-13 16:05 CEST
Nmap scan report for dc1.cascade.local (10.10.10.182)
Host is up (0.047s latency).
Not shown: 987 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
| dns-nsid:
|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2022-10-13 14:05:57Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
49154/tcp open  msrpc         Microsoft Windows RPC
49155/tcp open  msrpc         Microsoft Windows RPC
49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49158/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode:
|   2.1:
|_    Message signing enabled and required
|_clock-skew: -1s
| smb2-time:
|   date: 2022-10-13T14:06:48
|_  start_date: 2022-10-13T13:57:03
\end{verbatim}

\subsubsection{dns}

\begin{verbatim}
$ drill @10.10.10.182 any cascade.local
;; ->>HEADER<<- opcode: QUERY, rcode: NOERROR, id: 55210
;; flags: qr aa rd ra ; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 2
;; QUESTION SECTION:
;; cascade.local.       IN      ANY

;; ANSWER SECTION:
cascade.local.  600     IN      A       10.10.10.182
cascade.local.  600     IN      A       10.10.10.183
cascade.local.  3600    IN      NS      casc-dc1.cascade.local.
cascade.local.  3600    IN      SOA     casc-dc1.cascade.local. hostmaster.cascade.local. 117 900 600 86400 3600
cascade.local.  600     IN      AAAA    dead:beef::8a8:d14d:1d23:bbe2

;; AUTHORITY SECTION:

;; ADDITIONAL SECTION:
casc-dc1.cascade.local. 3600    IN      A       10.10.10.182
casc-dc1.cascade.local. 3600    IN      AAAA    dead:beef::eca6:5958:682b:a498

;; Query time: 25 msec
;; SERVER: 10.10.10.182
;; WHEN: Thu Oct 13 16:07:50 2022
;; MSG SIZE  rcvd: 205
$ dig @10.10.10.182 axfr cascade.local

; <<>> DiG 9.18.7 <<>> @10.10.10.182 axfr cascade.local
; (1 server found)
;; global options: +cmd
; Transfer failed.
\end{verbatim}

\subsubsection{smb}
\begin{verbatim}
 ===================================================
|    Domain Information via RPC for 10.10.10.182    |
 ===================================================
[+] Domain: CASCADE
[+] Domain SID: S-1-5-21-3332504370-1206983947-1165150453
[+] Membership: domain member
 ===============================================
|    OS Information via RPC for 10.10.10.182    |
 ===============================================
[*] Enumerating via unauthenticated SMB session on 445/tcp
[+] Found OS information via SMB
[*] Enumerating via 'srvinfo'
[-] Could not get OS info via 'srvinfo': STATUS_ACCESS_DENIED
[+] After merging OS information we have the following result:
OS: Windows 7, Windows Server 2008 R2
OS version: '6.1'
OS release: ''
OS build: '7601'
Native OS: not supported
Native LAN manager: not supported
Platform id: null
Server type: null
Server type string: null



 ======================================
|    Shares via RPC on 10.10.10.182    |
 ======================================
[*] Enumerating shares
[+] Found 0 share(s) for user '' with password '', try a different user

 =====================================
|    Users via RPC on 10.10.10.182    |
 =====================================
[*] Enumerating users via 'querydispinfo'
[+] Found 15 user(s) via 'querydispinfo'
[*] Enumerating users via 'enumdomusers'
[+] Found 15 user(s) via 'enumdomusers'
[+] After merging user results we have 15 user(s) total:
'1106':
  username: arksvc
  name: ArkSvc
  acb: '0x00000210'
  description: (null)
'1107':
  username: s.smith
  name: Steve Smith
  acb: '0x00000210'
  description: (null)
'1109':
  username: r.thompson
  name: Ryan Thompson
  acb: '0x00000210'
  description: (null)
'1111':
  username: util
  name: Util
  acb: '0x00000210'
  description: (null)
'1116':
  username: j.wakefield
  name: James Wakefield
  acb: '0x00000210'
  description: (null)
'1121':
  username: s.hickson
  name: Stephanie Hickson
  acb: '0x00000210'
  description: (null)
'1122':
  username: j.goodhand
  name: John Goodhand
  acb: '0x00000210'
  description: (null)
'1124':
  username: a.turnbull
  name: Adrian Turnbull
  acb: '0x00000214'
  description: (null)
'1127':
  username: e.crowe
  name: Edward Crowe
  acb: '0x00000211'
  description: (null)
'1128':
  username: b.hanson
  name: Ben Hanson
  acb: '0x00000211'
  description: (null)
'1129':
  username: d.burman
  name: David Burman
  acb: '0x00000210'
  description: (null)
'1130':
  username: BackupSvc
  name: BackupSvc
  acb: '0x00000210'
  description: (null)
'1134':
  username: j.allen
  name: Joseph Allen
  acb: '0x00000210'
  description: (null)
'1135':
  username: i.croft
  name: Ian Croft
  acb: '0x00000211'
  description: (null)
'501':
  username: CascGuest
  name: (null)
  acb: '0x00000215'
  description: Built-in account for guest access to the computer/domain

 ======================================
|    Groups via RPC on 10.10.10.182    |
 ======================================
[*] Enumerating local groups
[+] Found 17 group(s) via 'enumalsgroups domain'
[*] Enumerating builtin groups
[+] Found 15 group(s) via 'enumalsgroups builtin'
[*] Enumerating domain groups
[+] Found 6 group(s) via 'enumdomgroups'
[+] After merging groups results we have 38 group(s) total:
'1102':
  groupname: DnsAdmins
  type: local
'1103':
  groupname: DnsUpdateProxy
  type: domain
'1113':
  groupname: IT
  type: local
'1114':
  groupname: Production
  type: local
'1115':
  groupname: HR
  type: local
'1119':
  groupname: AD Recycle Bin
  type: local
'1120':
  groupname: Backup
  type: local
'1123':
  groupname: Temps
  type: local
'1125':
  groupname: WinRMRemoteWMIUsers__
  type: local
'1126':
  groupname: Remote Management Users
  type: local
'1132':
  groupname: Factory
  type: local
'1133':
  groupname: Finance
  type: local
'1137':
  groupname: Audit Share
  type: local
'1138':
  groupname: Data Share
  type: local
'498':
  groupname: Enterprise Read-only Domain Controllers
  type: domain
'513':
  groupname: Domain Users
  type: domain
'514':
  groupname: Domain Guests
  type: domain
'515':
  groupname: Domain Computers
  type: domain
'517':
  groupname: Cert Publishers
  type: local
'520':
  groupname: Group Policy Creator Owners
  type: domain
'545':
  groupname: Users
  type: builtin
'546':
  groupname: Guests
  type: builtin
'553':
  groupname: RAS and IAS Servers
  type: local
'554':
  groupname: Pre-Windows 2000 Compatible Access
  type: builtin
'555':
  groupname: Remote Desktop Users
  type: builtin
'556':
  groupname: Network Configuration Operators
  type: builtin
'557':
  groupname: Incoming Forest Trust Builders
  type: builtin
'558':
  groupname: Performance Monitor Users
  type: builtin
'559':
  groupname: Performance Log Users
  type: builtin
'560':
  groupname: Windows Authorization Access Group
  type: builtin
'561':
  groupname: Terminal Server License Servers
  type: builtin
'562':
  groupname: Distributed COM Users
  type: builtin
'568':
  groupname: IIS_IUSRS
  type: builtin
'569':
  groupname: Cryptographic Operators
  type: builtin
'571':
  groupname: Allowed RODC Password Replication Group
  type: local
'572':
  groupname: Denied RODC Password Replication Group
  type: local
'573':
  groupname: Event Log Readers
  type: builtin
'574':
  groupname: Certificate Service DCOM Access
  type: builtin
\end{verbatim}

\subsubsection{kerberos}
try asp-roast
\begin{verbatim}
$ kerbrute  userenum  --dc 10.10.10.182 -d cascade.local users.asc

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,< /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/

Version: dev (n/a) - 10/13/22 - Ronnie Flathers @ropnop

2022/10/13 16:25:39 >  Using KDC(s):
2022/10/13 16:25:39 >   10.10.10.182:88

2022/10/13 16:25:44 >  [+] VALID USERNAME:       j.wakefield@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       arksvc@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       r.thompson@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       util@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       s.smith@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       a.turnbull@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       j.goodhand@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       s.hickson@cascade.local
2022/10/13 16:25:50 >  [+] VALID USERNAME:       d.burman@cascade.local
2022/10/13 16:25:50 >  [+] VALID USERNAME:       BackupSvc@cascade.local
2022/10/13 16:25:50 >  [+] VALID USERNAME:       j.allen@cascade.local
2022/10/13 16:25:50 >  Done! Tested 15 usernames (11 valid) in 10.318 seconds
\end{verbatim}
11/15 ?

\begin{verbatim}
$ GetNPUsers.py cascade.local/ -usersfile users.asc -dc-ip 10.10.10.182
Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation

[-] User arksvc doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User s.smith doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User r.thompson doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User util doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User j.wakefield doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User s.hickson doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User j.goodhand doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User a.turnbull doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] User d.burman doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User BackupSvc doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User j.allen doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] invalid principal syntax
[-] invalid principal syntax
\end{verbatim}

\subsubsection{ldap}
\begin{verbatim}
$ ldapsearch -H ldap://casc-dc1.cascade.local -x -b "DC=cascade,dc=local" \
    -s sub  "(objectclass=user)"
\end{verbatim}


\subsection{Foothold}
\subsubsection{x}
\begin{verbatim}
\end{verbatim}

\subsubsection{x}

\begin{verbatim}

\end{verbatim}

\begin{verbatim}

\end{verbatim}
\section{Theorie}


